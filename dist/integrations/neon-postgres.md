# Neon Postgres

> Expert patterns for Neon serverless Postgres, branching, connection pooling, and Prisma/Drizzle integration

**Category:** integrations | **Version:** 1.0.0

**Tags:** neon, postgres, serverless, database, branching, prisma, drizzle, connection-pooling

---

## Patterns

### Prisma with Neon Connection
Configure Prisma for Neon with connection pooling.

Use two connection strings:
- DATABASE_URL: Pooled connection for Prisma Client
- DIRECT_URL: Direct connection for Prisma Migrate

The pooled connection uses PgBouncer for up to 10K connections.
Direct connection required for migrations (DDL operations).


### Drizzle with Neon Serverless Driver
Use Drizzle ORM with Neon's serverless HTTP driver for
edge/serverless environments.

Two driver options:
- neon-http: Single queries over HTTP (fastest for one-off queries)
- neon-serverless: WebSocket for transactions and sessions


### Connection Pooling with PgBouncer
Neon provides built-in connection pooling via PgBouncer.

Key limits:
- Up to 10,000 concurrent connections to pooler
- Connections still consume underlying Postgres connections
- 7 connections reserved for Neon superuser

Use pooled endpoint for application, direct for migrations.


### Database Branching for Development
Create instant copies of your database for development,
testing, and preview environments.

Branches share underlying storage (copy-on-write),
making them instant and cost-effective.


### Vercel Preview Environment Integration
Automatically create database branches for Vercel preview
deployments. Each PR gets its own isolated database.

Two integration options:
- Vercel-Managed: Billing in Vercel, auto-setup
- Neon-Managed: Billing in Neon, more control


### Autoscaling and Cold Start Management
Neon autoscales compute resources and scales to zero.

Cold start latency: 500ms - few seconds when waking from idle.
Production recommendation: Disable scale-to-zero, set minimum compute.



## Sharp Edges (Gotchas)

*Real production issues that cause outages and bugs.*

### [HIGH] undefined

---

### [HIGH] undefined

---

### [HIGH] undefined

---

### [MEDIUM] undefined

---

### [MEDIUM] undefined

---

### [LOW] undefined

---

### [MEDIUM] undefined

---

### [HIGH] undefined

---

### [MEDIUM] undefined

---

## Collaboration

### When to Hand Off

| Trigger | Delegate To | Context |
|---------|-------------|--------|
| `user needs authentication` | clerk-auth | User table with clerkId column |
| `user needs caching` | redis-specialist | Query caching, session storage |
| `user needs search` | algolia-search | Full-text search beyond Postgres capabilities |
| `user needs analytics` | segment-cdp | Track database events, user actions |
| `user needs deployment` | vercel-deployment | Environment variables, preview databases |

---

## Get the Full Version

This skill has **automated validations**, **detection patterns**, and **structured handoff triggers** that work with the Spawner orchestrator.

```bash
npx vibeship-spawner-skills install
```

Full skill path: `~/.spawner/skills/integrations/neon-postgres/`

**Includes:**
- `skill.yaml` - Structured skill definition
- `sharp-edges.yaml` - Machine-parseable gotchas with detection patterns
- `validations.yaml` - Automated code checks
- `collaboration.yaml` - Handoff triggers for skill orchestration

---

*Generated by [VibeShip Spawner](https://github.com/vibeforge1111/vibeship-spawner-skills)*
